{"version":3,"sources":["mitragyna.jsx"],"names":["Collection","state","target","prototype","build","bindAll","setTarget","props","nextProps","subject","setState","attributes","cloneTarget","push","newItem","oldItem","replace","item","delete","clone","blankComponent","children","className","component","componentProps","reflection","size","map","t","indexOf","replaceOnTarget","id","klass","toArray","PureComponent","propTypes","oneOfType","array","node","string","func","object","isRequired","defaultProps","inlineRows","ErrorsFor","nextState","nextContext","context","resource","errorComponent","errorProps","field","errors","forField","empty","customProps","omit","keys","finalComponent","createElement","key","error","code","message","Component","contextTypes","Field","type","value","changeRadio","radioValue","valueFor","afterChange","debounce","prevProps","prevState","prevResource","isNull","isUndefined","invalidClassName","name","componentRef","rnChangeHandler","classNames","ref","handleChange","renderCheckboxComponent","renderRadioComponent","renderRadioGroupComponent","renderSelectComponent","renderTextareaComponent","renderInputComponent","omittedProps","uncheckedValue","resourceValue","val","componentFor","commonInputProps","customInputProps","checked","questionId","includeBlank","options","optionsLabel","selectOptions","o","isString","unshift","e","max","min","persist","stateValue","queueChange","mappedValue","detect","noop","any","childContextTypes","bool","instanceOf","number","Resource","root","reflectionInstance","reflectOnAssociation","inverseReflection","inverseOf","queuedChanges","updating","queuedReflectionChanges","beforeSubmit","afterUpdate","afterUpdateRoot","shiftReflectionQueue","assignChanges","newResource","updateRoot","oldTarget","association","newTarget","collection","first","length","assignAttributes","change","queueReflectionChange","updatingRoot","shift","childContext","isNestedResource","callback","preventDefault","onSubmit","onInvalidSubmit","onSubmitCallback","resourceToSubmit","onInvalidSubmitCallback","invalidResource","Promise","resolve","reject","result","invalid","then","catch","afterError","rnComponent","rnComponentProps","body","handleSubmit","c","newRoot"],"mappings":"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","file":"mitragyna.min.js","sourcesContent":["import React from 'react';\nimport PropTypes from 'prop-types';\nimport ActiveResource from 'active-resource';\nimport _ from 'underscore';\n\nexport class Collection extends React.PureComponent {\n  static propTypes = {\n    children: PropTypes.oneOfType([\n      PropTypes.array,\n      PropTypes.node,\n    ]),\n    className: PropTypes.string,\n    blankComponent: PropTypes.func,\n    component: PropTypes.func,\n    componentProps: PropTypes.object,\n    subject: PropTypes.oneOfType([\n      PropTypes.object,\n      PropTypes.func,\n    ]).isRequired,\n    reflection: PropTypes.string,\n  };\n\n  static defaultProps = {\n    inlineRows: false\n  };\n\n  // link to global state by enabling afterLoad, afterAdd, afterRemove, afterUpdate callbacks that can call\n  // an action linked to dispatch\n\n  constructor() {\n    super();\n\n    this.state = {\n      target: ActiveResource.prototype.Collection.build()\n    };\n\n    _.bindAll(this,\n      'buildOnTarget',\n      'cloneTarget',\n      'replaceOnTarget',\n      'removeFromTarget',\n    );\n  }\n\n  componentDidMount() {\n    this.setTarget(this.props);\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.setTarget(nextProps);\n  }\n\n  setTarget(props) {\n    const { subject } = props;\n\n    this.setState({ target: subject.target() })\n  }\n\n  buildOnTarget(attributes) {\n    const { subject } = this.props;\n    let target = this.cloneTarget();\n\n    target.push(subject.build(attributes));\n\n    this.setState({ target: target });\n  }\n\n  replaceOnTarget(newItem, oldItem) {\n    let target = this.cloneTarget();\n\n    target.replace(oldItem, newItem);\n\n    return this.setState({ target });\n  }\n\n  removeFromTarget(item) {\n    let target = this.cloneTarget();\n\n    target.delete(item);\n\n    return this.setState({ target });\n  }\n\n  cloneTarget() {\n    return this.state.target.clone();\n  }\n\n  render() {\n    const { blankComponent, children, className, component, componentProps, reflection } = this.props;\n    const { target } = this.state;\n\n    return (\n      <section className={ className }>\n        {\n          target.size() > 0 ? (\n            target.map((t, indexOf) =>\n              <Resource afterUpdate={this.replaceOnTarget}\n                        component={component} componentProps={{...componentProps, indexOf}}\n                        key={t.id || (t.klass().className + '-' + indexOf)}\n                        reflection={reflection}\n                        subject={t}>\n\n\n                {children}\n              </Resource>\n            ).toArray()\n          ) : (blankComponent != null &&\n            blankComponent()\n          )\n        }\n      </section>\n    );\n  }\n}\n\nexport class ErrorsFor extends React.Component {\n  static propTypes = {\n    component: PropTypes.func,\n    errorComponent: PropTypes.func,\n    errorProps: PropTypes.object,\n    field: PropTypes.string,\n  };\n\n  static contextTypes = {\n    resource: PropTypes.object,\n  };\n\n  shouldComponentUpdate(nextProps, nextState, nextContext) {\n    return !(shallowEqual(this.props, nextProps) && shallowEqual(this.state, nextState) && shallowEqual(this.context, nextContext));\n  }\n\n  render() {\n    const { resource } = this.context;\n    const { component, errorComponent, errorProps, field } = this.props;\n\n    var errors = resource.errors().forField(field);\n\n    if(errors.empty()) return null;\n\n    let customProps = _.omit(this.props, _.keys(ErrorsFor.propTypes));\n\n    let finalComponent = component || 'summary';\n    return React.createElement(finalComponent, {\n      ...customProps,\n      key: field,\n    },\n      errors.map((error) => {\n        if (errorComponent) {\n          return React.createElement(\n            errorComponent,\n            {\n              ...errorProps,\n              key: error.code,\n            },\n            error.message\n          )\n        } else {\n          return <span key={ error.code }>{ error.message }</span>\n        }\n      }).toArray()\n    );\n  }\n};\n\nimport classNames from 'classnames';\nimport shallowEqual from 'shallowequal';\n\nexport class Field extends React.Component {\n  static contextTypes = {\n    changeRadio: PropTypes.func,\n    queueChange: PropTypes.func,\n    radioValue: PropTypes.any,\n    resource: PropTypes.object,\n  };\n\n  static childContextTypes = {\n    changeRadio: PropTypes.func,\n    radioValue: PropTypes.any,\n  };\n\n  static propTypes = {\n    className: PropTypes.string,\n    component: PropTypes.func,\n    componentRef: PropTypes.func,\n    includeBlank: PropTypes.bool,\n    name: PropTypes.string.isRequired,\n    options: PropTypes.instanceOf(ActiveResource.Collection),\n    optionsLabel: PropTypes.oneOfType([\n      PropTypes.string,\n      PropTypes.func,\n    ]),\n    rnChangeHandler: PropTypes.string,\n    type: PropTypes.string.isRequired,\n    uncheckedValue: PropTypes.oneOfType([\n      PropTypes.object,\n      PropTypes.func,\n      PropTypes.string,\n      PropTypes.number,\n    ]),\n    invalidClassName: PropTypes.string,\n    value: PropTypes.oneOfType([\n      PropTypes.object,\n      PropTypes.func,\n      PropTypes.string,\n      PropTypes.number,\n    ])\n  };\n\n  constructor() {\n    super();\n\n    _.bindAll(this,\n      'afterChange',\n      'changeRadio',\n      'classNames',\n      'commonInputProps',\n      'customInputProps',\n      'getValue',\n      'handleChange',\n      'renderCheckboxComponent',\n      'renderInputComponent',\n      'renderRadioComponent',\n      'renderSelectComponent',\n      'renderTextareaComponent',\n      'setValue',\n      'valueFor',\n    );\n\n    this.state = {};\n  }\n\n  shouldComponentUpdate(nextProps, nextState, nextContext) {\n    return !(shallowEqual(this.props, nextProps) && shallowEqual(this.state, nextState) && shallowEqual(this.context, nextContext));\n  }\n\n  getChildContext() {\n    const { type } = this.props;\n    const { value } = this.state;\n\n    switch(type) {\n      case 'radioGroup':\n        return {\n          changeRadio: this.changeRadio,\n          radioValue: value,\n        };\n    }\n  }\n\n  changeRadio(value) {\n    this.setState({ value });\n  }\n\n  componentWillMount() {\n    const { type } = this.props;\n    const { resource } = this.context;\n\n    // Set initial value to that of the resources\n    this.setState({\n      resource,\n      value: this.valueFor(resource, this.props)\n    });\n\n    switch(type) {\n      case 'email':\n      case 'number':\n      case 'text':\n      case 'textarea':\n        this.afterChange = _.debounce(this.afterChange, 500);\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { resource: prevResource } = prevState\n    const { resource } = this.context\n\n    if(prevResource !== resource) {\n      this.setState({ resource })\n    }\n\n    if(!(_.isNull(prevResource.id) || _.isUndefined(prevResource.id)) && prevResource.id !== resource.id) {\n      this.setState({\n        value: this.valueFor(resource, this.props)\n      })\n    }\n  }\n\n  classNames() {\n    const { className, invalidClassName, name } = this.props;\n    const { resource } = this.context;\n\n    return classNames(\n      className,\n      {\n        [invalidClassName]: !resource.errors().forField(name).empty()\n      }\n    );\n  }\n\n  commonInputProps() {\n    const { componentRef, name, rnChangeHandler } = this.props;\n\n    let props = {\n      className: this.classNames(),\n      key: name,\n      name,\n      ref: componentRef,\n      [rnChangeHandler || 'onChange']: this.handleChange,\n    };\n\n    return props;\n  }\n\n  componentFor(type) {\n    switch(type) {\n      case 'checkbox':\n        return this.renderCheckboxComponent();\n      case 'radio':\n        return this.renderRadioComponent();\n      case 'radioGroup':\n        return this.renderRadioGroupComponent();\n      case 'select':\n        return this.renderSelectComponent();\n      case 'textarea':\n        return this.renderTextareaComponent();\n      default:\n        return this.renderInputComponent();\n    }\n  }\n\n  // @note type='radio' will pass down +name+ prop\n  // @note type='select' will only pass down +type+ prop if +component+ prop is defined\n  customInputProps() {\n    const { component, type } = this.props;\n\n    var omittedProps;\n    switch(type) {\n      case 'radio':\n        omittedProps = _.omit(Field.propTypes, ['type', 'name']);\n        break;\n      case 'select':\n        omittedProps = component ? _.omit(Field.propTypes, 'type') : Field.propTypes;\n        break;\n      default:\n        omittedProps = _.omit(Field.propTypes, 'type');\n    }\n\n    return _.omit(this.props, _.keys(omittedProps));\n  }\n\n  // TODO: Add support for non-resource options on select and radioGroup\n  valueFor(resource, props) {\n    const { name, type, uncheckedValue, value } = props;\n\n    switch(type) {\n      case 'checkbox':\n        var resourceValue = resource[name];\n        if(resourceValue == value) {\n          return true;\n        } else if(resourceValue == uncheckedValue || _.isUndefined(resourceValue) || _.isNull(resourceValue)) {\n          return false;\n        } else {\n          throw 'Field ' + name + ' with value ' + resource[name] + ' does not match value or uncheckedValue for checkbox'\n        }\n      case 'radioGroup':\n      case 'select':\n        var val = resource[name]();\n        return val ? val.id : '';\n      default:\n        var val = resource[name];\n\n        return val ? val : '';\n    }\n  }\n\n  render() {\n    const { type } = this.props;\n\n    return this.componentFor(type);\n  }\n\n  renderCheckboxComponent() {\n    const { component } = this.props;\n\n    let finalComponent = component || 'input';\n    return React.createElement(finalComponent, {\n      ...this.commonInputProps(),\n      ...this.customInputProps(),\n      checked: this.state.value,\n    });\n  }\n\n  renderInputComponent() {\n    const { component } = this.props;\n\n    let finalComponent = component || 'input';\n    return React.createElement(finalComponent, {\n      ...this.commonInputProps(),\n      ...this.customInputProps(),\n      value: this.state.value,\n    });\n  }\n\n  renderRadioComponent() {\n    const { component, value } = this.props;\n    const { radioValue } = this.context;\n\n    if (_.isUndefined(value)) {\n      throw 'Input type=\"radio\" must have prop \"value\"';\n    }\n\n    let finalComponent = component || 'input';\n    return React.createElement(finalComponent, {\n      ...this.commonInputProps(),\n      ...this.customInputProps(),\n      checked: value.id == radioValue,\n      value: value.id,\n      name: value.questionId\n    });\n  }\n\n  renderRadioGroupComponent() {\n    return <div>\n      { this.props.children }\n    </div>;\n  }\n\n  renderSelectComponent() {\n    const { component, includeBlank, options, optionsLabel } = this.props;\n\n    let selectOptions = null;\n    if (options.empty()) {\n      throw 'Input type=\"select\" must have options';\n    } else {\n      selectOptions = options.map((o) => {\n        return <option key={o.id} value={o.id}>\n          {\n            _.isString(optionsLabel) ? (\n              o[optionsLabel]\n            ) : (\n              optionsLabel(o)\n            )\n          }\n        </option>;\n      });\n      if (includeBlank) {\n        selectOptions.unshift(<option key={-1} value=''></option>);\n      }\n    }\n\n    let finalComponent = component || 'select';\n    return React.createElement(finalComponent, {\n      ...this.commonInputProps(),\n      ...this.customInputProps(),\n      value: this.state.value,\n    }, selectOptions.toArray());\n  }\n\n  renderTextareaComponent() {\n    const { component } = this.props;\n\n    let finalComponent = component || 'textarea';\n    return React.createElement(finalComponent, {\n      ...this.commonInputProps(),\n      ...this.customInputProps(),\n      value: this.state.value,\n    });\n  }\n\n  handleChange(e) {\n    const { max, min, rnChangeHandler, type } = this.props;\n    const { changeRadio } = this.context;\n\n    if (!rnChangeHandler) e.persist();\n\n    let value;\n\n    switch(type) {\n      case 'checkbox':\n        value = e.target.checked;\n        break;\n      case 'number':\n        if(e.target.value > max) {\n          value = max;\n        } else if(e.target.value < min) {\n          value = min;\n        } else {\n          value = e.target.value || min;\n        }\n\n        break;\n      case 'radio':\n        changeRadio(e.target.value);\n        break;\n      default:\n        if (rnChangeHandler) {\n          value = e;\n        } else {\n          value = e.target.value;\n        }\n    }\n\n    this.setState({ value }, this.afterChange);\n  }\n\n  afterChange() {\n    const { name, type, options, uncheckedValue, value } = this.props;\n    const { value: stateValue } = this.state;\n    const { queueChange } = this.context;\n\n    let mappedValue;\n    switch(type) {\n      case 'checkbox':\n        if(stateValue) {\n          mappedValue = value;\n        } else {\n          mappedValue = uncheckedValue;\n        }\n        break;\n      case 'radio':\n        mappedValue = value;\n        break;\n      case 'select':\n        mappedValue = options.detect((o) => o.id === stateValue);\n        break;\n      default:\n        mappedValue = stateValue;\n    }\n\n    queueChange({ [name]: mappedValue });\n  }\n\n  getValue() {\n    return this.state.value;\n  }\n\n  setValue(value) {\n    const { type } = this.props;\n\n    let mappedValue = { persist: _.noop };\n    switch(type) {\n      case 'checkbox':\n        mappedValue = { ...mappedValue, target: { checked: value } };\n        break;\n      default:\n        mappedValue = { ...mappedValue, target: { value } };\n    }\n\n    this.handleChange(mappedValue);\n  }\n}\n\nexport class Resource extends React.PureComponent {\n  static propTypes = {\n    afterError: PropTypes.func,\n    afterUpdate: PropTypes.func,\n    children: PropTypes.oneOfType([\n      PropTypes.array,\n      PropTypes.node,\n    ]),\n    className: PropTypes.string,\n    component: PropTypes.func,\n    componentProps: PropTypes.object,\n    onInvalidSubmit: PropTypes.func,\n    onSubmit: PropTypes.func,\n    reflection: PropTypes.string,\n    rnComponent: PropTypes.func,\n    subject: PropTypes.object.isRequired,\n  };\n\n  static contextTypes = {\n    afterUpdateRoot: PropTypes.func,\n    isNestedResource: PropTypes.bool,\n    queuedReflectionChanges: PropTypes.array,\n    queueReflectionChange: PropTypes.func,\n    shiftReflectionQueue: PropTypes.func,\n    root: PropTypes.object,\n    updateRoot: PropTypes.func,\n    updatingRoot: PropTypes.bool,\n  };\n\n  static childContextTypes = {\n    afterUpdateRoot: PropTypes.func,\n    isNestedResource: PropTypes.bool,\n    queueChange: PropTypes.func,\n    queuedReflectionChanges: PropTypes.array,\n    queueReflectionChange: PropTypes.func,\n    shiftReflectionQueue: PropTypes.func,\n    resource: PropTypes.object,\n    root: PropTypes.object,\n    updateRoot: PropTypes.func,\n    updatingRoot: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    componentProps: {},\n    componentRef: _.noop,\n    rnComponentProps: {}\n  };\n\n  constructor(props, context) {\n    super();\n\n    _.bindAll(this,\n      'afterUpdate',\n      'assignChanges',\n      'queueReflectionChange',\n      'shiftReflectionQueue',\n      'queueChange',\n      'handleSubmit',\n      'updateRoot'\n    );\n\n    const { root } = context;\n    const { reflection, subject } = props;\n\n    let state = { resource: subject };\n\n    if(reflection) {\n      var reflectionInstance = root.klass().reflectOnAssociation(reflection);\n      if(_.isUndefined(reflectionInstance)) throw 'Reflection ' + reflection + ' not found.';\n      var inverseReflection = reflectionInstance.inverseOf();\n      if(_.isUndefined(inverseReflection)) throw 'Reflection ' + reflection + ' must have inverse.';\n\n      state = {\n        ...state,\n        inverseReflection,\n        queuedChanges: {},\n        reflection: reflectionInstance,\n        updating: false,\n      };\n    } else {\n      state = {\n        ...state,\n        queuedReflectionChanges: []\n      }\n    }\n\n    this.beforeSubmit = props.beforeSubmit;\n    this.state = state;\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const { afterUpdate } = this.props;\n    const { inverseReflection } = this.state;\n    const { afterUpdateRoot, queuedReflectionChanges, shiftReflectionQueue } = this.context;\n\n    this.setState({ resource: nextProps.subject });\n\n    if(afterUpdate && !inverseReflection) {\n      this.setState({ updating: false });\n      this.assignChanges();\n    } else {\n      if(afterUpdateRoot && inverseReflection && queuedReflectionChanges[0] === this) {\n        shiftReflectionQueue();\n        this.assignChanges();\n      }\n    }\n  }\n\n  componentDidCatch(error) {\n    return <p>{ error }</p>;\n  }\n\n  afterUpdate(newResource) {\n    const { updateRoot } = this.context;\n    const { inverseReflection, resource } = this.state;\n\n    if(inverseReflection) {\n      var oldTarget = resource.association(inverseReflection.name).target;\n      var newTarget = newResource.association(inverseReflection.name).target;\n\n      if(inverseReflection.collection()) {\n        // FIXME: Allow autosave inverseOf collection to appropriately handle multiple resources in the collection,\n        //   not just the first. If changing multiple fields of resource quickly, root may not be found in oldTarget\n        //   because it has already been replaced by a previous change\n        // var index = oldTarget.indexOf(root);\n        // var newRoot = newTarget.get(index);\n        updateRoot(newTarget.first());\n      } else {\n        updateRoot(newTarget);\n      }\n    } else {\n      this.updateRoot(newResource);\n    }\n  }\n\n  assignChanges() {\n    const { queuedChanges, resource } = this.state;\n\n    if(_.keys(queuedChanges).length == 0) return;\n\n    var newResource = resource.assignAttributes(queuedChanges);\n\n    this.setState({ queuedChanges: {} });\n\n    this.afterUpdate(newResource);\n  }\n\n  queueChange(change) {\n    const { afterUpdate } = this.props;\n    const { inverseReflection, queuedChanges, updating } = this.state;\n\n    this.setState({\n      queuedChanges: {\n        ...queuedChanges,\n        ...change\n      }\n    }, () => {\n      const { afterUpdateRoot, queueReflectionChange, updatingRoot } = this.context;\n\n      if(afterUpdate || afterUpdateRoot) {\n        if(inverseReflection) {\n          if(updatingRoot) {\n            queueReflectionChange(this);\n          } else {\n            this.assignChanges();\n          }\n        } else {\n          if(!updating) this.assignChanges();\n        }\n      } else {\n        this.assignChanges();\n      }\n    });\n  }\n\n  queueReflectionChange(resource) {\n    let { queuedReflectionChanges } = this.state;\n\n    queuedReflectionChanges.push(resource);\n    this.setState({ queuedReflectionChanges });\n  }\n\n  shiftReflectionQueue() {\n    let { queuedReflectionChanges } = this.state;\n\n    queuedReflectionChanges.shift();\n    this.setState({ queuedReflectionChanges });\n  }\n\n  getChildContext() {\n    const { afterUpdate } = this.props;\n    const { root } = this.context;\n    const { resource, queuedReflectionChanges, updating } = this.state;\n\n    let childContext = {\n      afterUpdateRoot: afterUpdate,\n      isNestedResource: true,\n      queueChange: this.queueChange,\n      queuedReflectionChanges: queuedReflectionChanges,\n      queueReflectionChange: this.queueReflectionChange,\n      shiftReflectionQueue: this.shiftReflectionQueue,\n      root: root || resource,\n      resource,\n      updateRoot: this.updateRoot,\n      updatingRoot: updating,\n    };\n\n    return childContext;\n  }\n\n  handleSubmit(e, callback) {\n    if(e) e.preventDefault();\n\n    const { onSubmit, onInvalidSubmit } = this.props;\n    const { resource } = this.state;\n\n    var onSubmitCallback = (resourceToSubmit) => {\n      if(!_.isUndefined(onSubmit)) {\n        onSubmit(resourceToSubmit);\n      }\n\n      if(!_.isUndefined(callback)) {\n        callback(resourceToSubmit);\n      }\n    };\n\n    var onInvalidSubmitCallback = (invalidResource) => {\n      if(!_.isUndefined(onInvalidSubmit)) {\n        onInvalidSubmit(invalidResource);\n      }\n\n      if(!_.isUndefined(callback)) {\n        callback(invalidResource);\n      }\n    };\n\n    let beforeSubmit = this.beforeSubmit || (this.componentRef && this.componentRef.beforeSubmit);\n    if(!_.isUndefined(beforeSubmit)) {\n      new Promise((resolve, reject) => {\n        try {\n          var result = beforeSubmit(resource);\n          resolve(result);\n        } catch(invalid) {\n          reject(invalid);\n        }\n      }).then(onSubmitCallback).catch(onInvalidSubmitCallback)\n    } else {\n      onSubmitCallback(resource);\n    }\n  }\n\n  render() {\n    const { isNestedResource } = this.context;\n    const { afterError, children, className, component, componentProps, componentRef, rnComponent, rnComponentProps } = this.props;\n    const { resource } = this.state;\n\n    let body;\n    if(component) {\n      body = React.createElement(component, {\n        ...componentProps,\n        afterUpdate: this.afterUpdate,\n        afterError,\n        onSubmit: this.handleSubmit,\n        subject: resource,\n        ref: (c) => { this.componentRef = c; componentRef(c) }\n      });\n    } else {\n      body = children;\n    }\n\n    if(rnComponent) {\n      return React.createElement(\n        rnComponent,\n        rnComponentProps,\n        body\n      )\n    } else {\n      if(isNestedResource) {\n        return (\n          <section className={ className }>\n            { body }\n          </section>\n        );\n      } else {\n        return <form className={className} onSubmit={ this.handleSubmit }>{ body }</form>;\n      }\n    }\n  }\n\n  updateRoot(newRoot) {\n    const { afterUpdate } = this.props;\n    const { resource } = this.state;\n\n    this.setState({ resource: newRoot });\n\n    if(afterUpdate) {\n      afterUpdate(newRoot, resource);\n      this.setState({ updating: true })\n    }\n  }\n}\n"]}